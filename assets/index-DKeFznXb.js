(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function R(e){const t=S(e),n=N(e),r=new Map(n.map(i=>[i.key,i])),s=new Set;return n.map(i=>{if(i.fields.crossref){const a=i.fields.crossref,c=r.get(a);if(c)return s.add(a),{...i,fields:{...c.fields,...i.fields}}}return i}).filter(i=>!s.has(i.key)).map(i=>A(i,t)).filter(i=>i!==null)}function S(e){const t={},n=/@string\s*\{\s*(\w+)\s*=\s*\{([^}]*)\}\s*\}/gi;let r;for(;(r=n.exec(e))!==null;)t[r[1].toLowerCase()]=r[2].trim();return t}function N(e){const t=[],n=/@(\w+)\s*\{\s*([^,\s]+)\s*,/g;let r,s=0;for(;(r=n.exec(e))!==null;){const o=r[1].toLowerCase(),i=r[2],a=r.index+r[0].length;if(["preamble","string","comment"].includes(o))continue;const c=D(e,a);if(c){const g=_(c);t.push({type:o,key:i,fields:g,index:s++})}}return t}function D(e,t){let n=1,r=t;for(;r<e.length&&n>0;)e[r]==="{"?n++:e[r]==="}"&&n--,r++;return n===0?e.slice(t,r-1):null}function _(e){const t={},n=/(\w+)\s*=\s*(?:\{([^{}]*(?:\{[^{}]*\}[^{}]*)*)\}|"([^"]*)"|(\w+))/g;let r;for(;(r=n.exec(e))!==null;){const s=r[1].toLowerCase(),o=r[2]||r[3]||r[4]||"";t[s]=s==="note"?o.trim():$(o.trim())}return t}function $(e){return e?e.replace(/\$\^[\{]?([^\$\}]+)[\}]?\$/g,"<sup>$1</sup>").replace(/\^\{([^}]+)\}/g,"<sup>$1</sup>").replace(/\$_[\{]?([^\$\}]+)[\}]?\$/g,"<sub>$1</sub>").replace(/_\{([^}]+)\}/g,"<sub>$1</sub>").replace(/\\href\{([^}]*)\}\{([^}]*)\}/g,"$2").replace(/\\url\{([^}]*)\}/g,"$1").replace(/\\&/g,"&").replace(/\\\\/g,"").replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\`/g,"`").replace(/\\~/g,"~").replace(/\\textit\{([^}]*)\}/g,"<em>$1</em>").replace(/\\textbf\{([^}]*)\}/g,"<strong>$1</strong>").replace(/\\emph\{([^}]*)\}/g,"<em>$1</em>").replace(/[\{\}]/g,"").replace(/\$/g,"").replace(/\\coe/g,"*").replace(/\s+/g," ").trim():""}function A(e,t){const n=e.fields;let r=n.booktitle||n.journal||"";const s=r.toLowerCase();t[s]&&(r=t[s]),r=r.replace(/#\s*"-?/g," ").replace(/-?"/g,"").trim();let o=n.url||null;if(n.note){const l=n.note.match(/https?:\/\/[^\s}]+(?:pdf|html|org)?/i);l&&(o=l[0])}if(!o&&n.note&&n.note.includes("http")){const l=n.note.match(/(https?:\/\/[^\s]+)/);l&&(o=l[1])}let i="misc";const a=e.type.toLowerCase();if(a==="inproceedings"||a==="conference"?i="conference":a==="article"?i="journal":a==="book"||a==="booklet"||a==="incollection"?i="book":a==="techreport"?i="techreport":(a==="phdthesis"||a==="mastersthesis")&&(i="thesis"),a==="misc"||a==="unpublished")return null;let c=n.url||null;if(c&&(c=c.replace(/\\url\{([^}]*)\}/g,"$1").replace(/[\{\}]/g,"")),n.note){const l=n.note.match(/https?:\/\/[^\s}]+(?:pdf|html|org)?/i);l&&(!c||l[0].toLowerCase().includes(".pdf"))&&(o=l[0])}const g=o||c,h={conference:1,journal:2,techreport:3,preprint:4,misc:5};return{key:e.key,type:i,typePriority:h[i]||99,title:n.title||"Untitled",authors:H(n.author||""),year:parseInt(n.year)||0,venue:$(r),pages:n.pages||"",doi:n.doi||null,url:g,note:n.note?$(n.note):null,awards:n.note_award?n.note_award.split(";").map(l=>$(l.trim())).filter(Boolean):[],publisher:n.publisher||null,volume:n.volume||null,number:n.number||null,originalIndex:e.index}}function H(e){return e?e.split(/\s+and\s+/i).map(n=>{if(n=n.replace(/\$\^[^$]*\$/g,"").trim(),n.includes(",")){const r=n.split(",").map(s=>s.trim());if(r.length>=2)return`${r[1]} ${r[0]}`}return n}).join(", "):""}function V(e){const t={};return e.forEach(r=>{const s=r.year||"Unknown";t[s]||(t[s]=[]),t[s].push(r)}),Object.keys(t).sort((r,s)=>(parseInt(s)||0)-(parseInt(r)||0)).map(r=>{const s=t[r].sort((o,i)=>o.typePriority-i.typePriority);return{year:r,publications:s}})}function Y(e){const t={journal:"Journal Articles",conference:"Conference Papers",preprint:"Preprints",techreport:"Technical Reports",misc:"Other"},n={};return e.forEach(s=>{const o=s.type||"misc";n[o]||(n[o]=[]),n[o].push(s)}),["conference","journal","techreport","preprint","misc"].filter(s=>n[s]&&n[s].length>0).map(s=>({year:t[s]||s,publications:n[s].sort((o,i)=>(i.year||0)-(o.year||0))}))}function z(e){return[{year:"All Publications",publications:e.sort((t,n)=>(t.originalIndex||0)-(n.originalIndex||0))}]}function W(e){const t=e.trim().split(`
`);if(t.length<2)return[];const n=k(t[0]).map(o=>o.toLowerCase().trim()),r={title:u(n,["title","paper","paper title"]),authors:u(n,["author","authors","author(s)"]),year:u(n,["year","date","publication year","pub year"]),venue:u(n,["venue","journal","conference","booktitle","publication"]),type:u(n,["type","publication type","entry type"]),doi:u(n,["doi"]),url:u(n,["url","link"]),pages:u(n,["pages","page"]),volume:u(n,["volume","vol"]),number:u(n,["number","issue"]),publisher:u(n,["publisher"]),abstract:u(n,["abstract"])},s=[];for(let o=1;o<t.length;o++){const i=t[o].trim();if(!i)continue;const a=k(i),c=X(a,r,o);c.title&&s.push(c)}return s}function k(e){const t=[];let n="",r=!1;for(let s=0;s<e.length;s++){const o=e[s],i=e[s+1];o==='"'?r&&i==='"'?(n+='"',s++):r=!r:o===","&&!r?(t.push(n.trim()),n=""):n+=o}return t.push(n.trim()),t}function u(e,t){for(const n of t){const r=e.indexOf(n);if(r!==-1)return r}return-1}function X(e,t,n){const r=y=>y>=0&&y<e.length?e[y]:"",s=r(t.title),o=r(t.authors),i=r(t.year),a=r(t.venue),c=r(t.type);let g=0;if(i){const y=i.match(/\d{4}/);y&&(g=parseInt(y[0]))}let h="misc";const l=c.toLowerCase();l.includes("conference")||l.includes("inproceedings")?h="conference":l.includes("article")||l.includes("journal")?h="article":(l.includes("preprint")||l.includes("arxiv"))&&(h="preprint");const F=q(o);return{key:`csv_entry_${n}`,type:h,title:s||"Untitled",authors:F,year:g,venue:a,pages:r(t.pages),doi:r(t.doi)||null,url:r(t.url)||null,pdfUrl:null,eprint:null,publisher:r(t.publisher)||null,volume:r(t.volume)||null,number:r(t.number)||null}}function q(e){if(!e)return"";let t=e.split(/\s*;\s*|\s+and\s+/i).map(n=>n.trim()).filter(n=>n.length>0);if(t.length===1&&t[0].includes(",")){const n=t[0].split(",").map(r=>r.trim());n.length>2&&(t=n)}return t.join(", ")}function K(e,t){if(t.innerHTML="",!e||e.length===0){t.innerHTML=`
            <div class="empty-state">
                <span class="empty-icon">üìñ</span>
                <p>No publications found</p>
            </div>
        `;return}e.forEach((n,r)=>{const s=document.createElement("div");s.className="year-group",s.style.animationDelay=`${r*.1}s`,s.innerHTML=`
            <div class="year-header">
                <span class="year-badge">${n.year}</span>
                <span class="year-count">${n.publications.length} publication${n.publications.length!==1?"s":""}</span>
            </div>
            <div class="year-publications">
                ${n.publications.map((o,i)=>J(o,i,n.year==="All Publications"||isNaN(n.year))).join("")}
            </div>
        `,t.appendChild(s)})}function J(e,t,n=!1){const r=Q(e),s=e.pdfUrl||e.url||e.doi?`<a href="${e.pdfUrl||e.url||`https://doi.org/${e.doi}`}" target="_blank" rel="noopener">${b(e.title)}</a>`:b(e.title);return`
        <article class="pub-card" style="animation-delay: ${t*.05}s">
            <div class="pub-content">
                <h3 class="pub-title">${s}<span class="pub-type-badge ${e.type}">${Z(e.type)}</span></h3>
                <p class="pub-authors">${b(e.authors)}</p>
                <div class="pub-venue">
                    ${e.venue?`<span>${b(e.venue)}</span>`:""}
                    ${n&&e.year?`<span>(${e.year})</span>`:""}
                    ${e.pages?`<span>pp. ${e.pages}</span>`:""}
                </div>
                ${e.awards&&e.awards.length>0?`
                    <div class="pub-awards">
                        ${e.awards.map(o=>`<span class="pub-award">üèÜ ${b(o)}</span>`).join("")}
                    </div>
                `:""}
                ${r.length>0?`
                    <div class="pub-links">
                        ${r.join("")}
                    </div>
                `:""}
            </div>
        </article>
    `}function Q(e){const t=[];return e.pdfUrl&&t.push(`<a href="${e.pdfUrl}" class="pub-link" target="_blank" rel="noopener">PDF</a>`),e.doi&&t.push(`<a href="https://doi.org/${e.doi}" class="pub-link" target="_blank" rel="noopener">DOI</a>`),e.eprint&&t.push(`<a href="https://arxiv.org/abs/${e.eprint}" class="pub-link" target="_blank" rel="noopener">arXiv</a>`),t}function Z(e){return{conference:"Conference",journal:"Journal",book:"Book",techreport:"Tech Report",thesis:"Thesis",preprint:"Preprint",misc:"Other"}[e]||"Other"}function G(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function b(e){return e?G(e).replace(/&lt;sup&gt;/g,"<sup>").replace(/&lt;\/sup&gt;/g,"</sup>").replace(/&lt;sub&gt;/g,"<sub>").replace(/&lt;\/sub&gt;/g,"</sub>").replace(/&lt;em&gt;/g,"<em>").replace(/&lt;\/em&gt;/g,"</em>").replace(/&lt;strong&gt;/g,"<strong>").replace(/&lt;\/strong&gt;/g,"</strong>"):""}function U(e){const t=e.length,n=new Set(e.map(s=>s.year).filter(s=>s>0)),r=new Set(e.map(s=>s.venue).filter(s=>s));document.getElementById("totalPubs").textContent=t,document.getElementById("totalYears").textContent=n.size,document.getElementById("totalVenues").textContent=r.size,document.getElementById("stats-section").style.display="block"}let E="bib",d=[],x="",w="";const C=document.getElementById("fileInput"),p=document.getElementById("dropZone"),v=document.getElementById("urlInput"),M=document.getElementById("loadUrlBtn"),ee=document.getElementById("publications-container"),te=document.getElementById("filtersSection"),I=document.getElementById("loadingOverlay"),T=document.querySelectorAll(".group-btn"),ne=document.getElementById("exportFormat"),re=document.getElementById("searchInput"),B=document.getElementById("excludePreprints"),se="https://raw.githubusercontent.com/dynaroars/latex-cv/main/cv.bib";function oe(){ie();const t=new URLSearchParams(window.location.search).get("bib"),n=t||se;if(t){document.body.classList.add("show-mode");const r=document.querySelector(".upload-box");r&&(r.style.display="none")}v.value=n,P(n)}function ie(){C.addEventListener("change",ae),p.addEventListener("dragover",le),p.addEventListener("dragleave",ce),p.addEventListener("drop",ue),p.addEventListener("click",e=>{e.target.tagName!=="INPUT"&&e.target.tagName!=="BUTTON"&&!e.target.closest(".url-row")&&C.click()}),M.addEventListener("click",e=>{e.stopPropagation(),P(v.value)}),v.addEventListener("keydown",e=>{e.key==="Enter"&&P(v.value)}),v.addEventListener("click",e=>{e.stopPropagation()}),T.forEach(e=>{e.addEventListener("click",()=>{T.forEach(t=>t.classList.remove("active")),e.classList.add("active"),x=e.dataset.group,L()})}),ne.addEventListener("change",e=>{e.target.value&&d.length>0&&(de(e.target.value),e.target.value="")}),re.addEventListener("input",e=>{w=e.target.value.toLowerCase().trim(),L()}),B.addEventListener("change",()=>{L()})}function ae(e){const t=e.target.files[0];t&&j(t)}function le(e){e.preventDefault(),e.stopPropagation(),p.classList.add("drag-over")}function ce(e){e.preventDefault(),e.stopPropagation(),p.classList.remove("drag-over")}function ue(e){e.preventDefault(),e.stopPropagation(),p.classList.remove("drag-over");const t=e.dataTransfer.files[0];t&&(t.name.endsWith(".bib")||t.name.endsWith(".bibtex")||t.name.endsWith(".csv"))?j(t):m("Please drop a valid .bib or .csv file")}function j(e){f(!0),E=e.name.endsWith(".csv")?"csv":"bib";const t=new FileReader;t.onload=n=>O(n.target.result,E),t.onerror=()=>{f(!1),m("Failed to read file")},t.readAsText(e)}async function P(e){if(!e){m("Please enter a URL");return}try{new URL(e)}catch{m("Please enter a valid URL");return}e.includes("github.com")&&e.includes("/blob/")&&(e=e.replace("github.com","raw.githubusercontent.com").replace("/blob/","/"),v.value=e),E=e.toLowerCase().endsWith(".csv")?"csv":"bib",f(!0);try{let t,n;try{if(t=await fetch(e),!t.ok)throw new Error(`HTTP ${t.status}`)}catch(s){n=s,t=null}if(!t)try{const s=`https://api.allorigins.win/raw?url=${encodeURIComponent(e)}`;if(t=await fetch(s),!t.ok)throw new Error(`HTTP ${t.status}`)}catch(s){n=s,t=null}if(!t)try{const s=`https://corsproxy.io/?${encodeURIComponent(e)}`;if(t=await fetch(s),!t.ok)throw new Error(`HTTP ${t.status}`)}catch(s){n=s,t=null}if(!t)throw n||new Error("Failed to fetch from all sources");const r=await t.text();O(r,E)}catch(t){f(!1),m(`Failed to load file: ${t.message}`)}}function O(e,t){try{if(d=t==="csv"?W(e):R(e),d.length===0){f(!1),m(`No publications found in the ${t.toUpperCase()} file`);return}U(d),L(),te.style.display="flex",f(!1)}catch(n){f(!1),m(`Failed to parse ${t.toUpperCase()}: ${n.message}`),console.error("Parse error:",n)}}function L(){let e=d;w&&(e=e.filter(r=>{var o;return[r.title,r.authors,r.venue,(o=r.year)==null?void 0:o.toString(),r.type].filter(Boolean).join(" ").toLowerCase().includes(w)})),B.checked&&(e=e.filter(r=>r.type!=="preprint"));let t;x==="year"?t=V(e):x==="type"?t=Y(e):t=z(e),K(t,ee),U(e);const n=document.getElementById("searchCount");n&&(n.textContent=w?`Showing ${e.length} of ${d.length}`:"")}function f(e){e?I.classList.remove("hidden"):I.classList.add("hidden")}function m(e){const t=document.createElement("div");t.style.cssText=`
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        padding: 1rem 2rem;
        background: #333;
        color: white;
        font-weight: 500;
        z-index: 1000;
        animation: fadeIn 0.3s ease;
    `,t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity 0.3s ease",setTimeout(()=>t.remove(),300)},4e3)}function de(e){let t,n,r;switch(e){case"bibtex":t=pe(d),n="publications.bib",r="text/plain";break;case"csv":t=fe(d),n="publications.csv",r="text/csv";break;default:return}me(t,n,r)}function pe(e){return e.map(t=>{let r=`@${t.type==="article"?"article":t.type==="conference"?"inproceedings":"misc"}{${t.key},
`;return r+=`  title = {${t.title}},
`,r+=`  author = {${t.authors}},
`,t.year&&(r+=`  year = {${t.year}},
`),t.venue&&(t.type==="article"?r+=`  journal = {${t.venue}},
`:r+=`  booktitle = {${t.venue}},
`),t.pages&&(r+=`  pages = {${t.pages}},
`),t.doi&&(r+=`  doi = {${t.doi}},
`),t.url&&(r+=`  url = {${t.url}},
`),t.volume&&(r+=`  volume = {${t.volume}},
`),t.number&&(r+=`  number = {${t.number}},
`),t.publisher&&(r+=`  publisher = {${t.publisher}},
`),r+=`}
`,r}).join(`
`)}function fe(e){const t=["Title","Authors","Year","Type","Venue","Pages","DOI","URL"],n=e.map(r=>[`"${(r.title||"").replace(/"/g,'""')}"`,`"${(r.authors||"").replace(/"/g,'""')}"`,r.year||"",r.type||"",`"${(r.venue||"").replace(/"/g,'""')}"`,r.pages||"",r.doi||"",r.url||""]);return[t.join(","),...n.map(r=>r.join(","))].join(`
`)}function me(e,t,n){const r=new Blob([e],{type:n}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}oe();
