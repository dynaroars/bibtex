(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function A(e){const t=H(e),n=M(e),r=new Map(n.map(i=>[i.key,i])),s=new Set;return n.map(i=>{if(i.fields.crossref){const a=i.fields.crossref,c=r.get(a);if(c)return s.add(a),{...i,fields:{...c.fields,...i.fields},raw:i.raw+`

`+c.raw}}return i}).filter(i=>!s.has(i.key)).map(i=>z(i,t)).filter(i=>i!==null)}function H(e){const t={},n=/@string\s*\{\s*(\w+)\s*=\s*\{([^}]*)\}\s*\}/gi;let r;for(;(r=n.exec(e))!==null;)t[r[1].toLowerCase()]=r[2].trim();return t}function M(e){const t=[],n=/@(\w+)\s*\{\s*([^,\s]+)\s*,/g;let r,s=0;for(;(r=n.exec(e))!==null;){const o=r[1].toLowerCase(),i=r[2],a=r.index;if(["preamble","string","comment"].includes(o))continue;const{fieldsContent:c,rawContent:y}=V(e,a);if(c){const p=Y(c);t.push({type:o,key:i,fields:p,raw:y,index:s++})}}return t}function V(e,t){let n=0,r=t,s=!1,o=-1;for(;r<e.length;){if(e[r]==="{")s||(s=!0,o=r+1),n++;else if(e[r]==="}"&&(n--,s&&n===0))return{fieldsContent:e.slice(o,r),rawContent:e.slice(t,r+1)};r++}return{fieldsContent:null,rawContent:null}}function Y(e){const t={},n=/(\w+)\s*=\s*(?:\{([^{}]*(?:\{[^{}]*\}[^{}]*)*)\}|"([^"]*)"|(\w+))/g;let r;for(;(r=n.exec(e))!==null;){const s=r[1].toLowerCase(),o=r[2]||r[3]||r[4]||"";t[s]=s==="note"?o.trim():$(o.trim())}return t}function $(e){return e?e.replace(/\$\^[\{]?([^\$\}]+)[\}]?\$/g,"<sup>$1</sup>").replace(/\^\{([^}]+)\}/g,"<sup>$1</sup>").replace(/\$_[\{]?([^\$\}]+)[\}]?\$/g,"<sub>$1</sub>").replace(/_\{([^}]+)\}/g,"<sub>$1</sub>").replace(/\\href\{([^}]*)\}\{([^}]*)\}/g,"$2").replace(/\\url\{([^}]*)\}/g,"$1").replace(/\\&/g,"&").replace(/\\\\/g,"").replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\`/g,"`").replace(/\\~/g,"~").replace(/\\textit\{([^}]*)\}/g,"<em>$1</em>").replace(/\\textbf\{([^}]*)\}/g,"<strong>$1</strong>").replace(/\\emph\{([^}]*)\}/g,"<em>$1</em>").replace(/[\{\}]/g,"").replace(/\$/g,"").replace(/\\coe/g,"*").replace(/\s+/g," ").trim():""}function z(e,t){const n=e.fields;let r=n.booktitle||n.journal||"";const s=r.toLowerCase();t[s]&&(r=t[s]),r=r.replace(/#\s*"-?/g," ").replace(/-?"/g,"").trim();let o=n.url||null;if(n.note){const l=n.note.match(/https?:\/\/[^\s}]+(?:pdf|html|org)?/i);l&&(o=l[0])}if(!o&&n.note&&n.note.includes("http")){const l=n.note.match(/(https?:\/\/[^\s]+)/);l&&(o=l[1])}let i="misc";const a=e.type.toLowerCase();if(a==="inproceedings"||a==="conference"?i="conference":a==="article"?i="journal":a==="book"||a==="booklet"||a==="incollection"?i="book":a==="techreport"?i="techreport":(a==="phdthesis"||a==="mastersthesis")&&(i="thesis"),a==="misc"||a==="unpublished")return null;let c=n.url||null;if(c&&(c=c.replace(/\\url\{([^}]*)\}/g,"$1").replace(/[\{\}]/g,"")),n.note){const l=n.note.match(/https?:\/\/[^\s}]+(?:pdf|html|org)?/i);l&&(!c||l[0].toLowerCase().includes(".pdf"))&&(o=l[0])}const y=o||c,p={book:0,conference:1,journal:2,techreport:3,thesis:4,preprint:5,misc:6};return{key:e.key,type:i,typePriority:p[i]||99,title:n.title||"Untitled",authors:W(n.author||""),year:parseInt(n.year)||0,venue:$(r),pages:n.pages||"",doi:n.doi||null,url:y,note:n.note?$(n.note):null,awards:n.note_award?n.note_award.split(";").map(l=>$(l.trim())).filter(Boolean):[],publisher:n.publisher||null,volume:n.volume||null,number:n.number||null,originalIndex:e.index,raw:e.raw}}function W(e){return e?e.split(/\s+and\s+/i).map(n=>{if(n=n.replace(/\$\^[^$]*\$/g,"").trim(),n.includes(",")){const r=n.split(",").map(s=>s.trim());if(r.length>=2)return`${r[1]} ${r[0]}`}return n}).join(", "):""}function X(e){const t={};return e.forEach(r=>{const s=r.year||"Unknown";t[s]||(t[s]=[]),t[s].push(r)}),Object.keys(t).sort((r,s)=>(parseInt(s)||0)-(parseInt(r)||0)).map(r=>{const s=t[r].sort((o,i)=>o.typePriority-i.typePriority);return{year:r,publications:s}})}function K(e){const t={book:"Books",journal:"Journal Articles",conference:"Conference Papers",preprint:"Preprints",techreport:"Technical Reports",thesis:"Theses",misc:"Other"},n={};return e.forEach(s=>{const o=s.type||"misc";n[o]||(n[o]=[]),n[o].push(s)}),["book","conference","journal","techreport","thesis","preprint","misc"].filter(s=>n[s]&&n[s].length>0).map(s=>({year:t[s]||s,publications:n[s].sort((o,i)=>(i.year||0)-(o.year||0))}))}function q(e){return[{year:"All Publications",publications:e.sort((t,n)=>(t.originalIndex||0)-(n.originalIndex||0))}]}function J(e){const t=e.trim().split(`
`);if(t.length<2)return[];const n=P(t[0]).map(o=>o.toLowerCase().trim()),r={title:d(n,["title","paper","paper title"]),authors:d(n,["author","authors","author(s)"]),year:d(n,["year","date","publication year","pub year"]),venue:d(n,["venue","journal","conference","booktitle","publication"]),type:d(n,["type","publication type","entry type"]),doi:d(n,["doi"]),url:d(n,["url","link"]),pages:d(n,["pages","page"]),volume:d(n,["volume","vol"]),number:d(n,["number","issue"]),publisher:d(n,["publisher"]),abstract:d(n,["abstract"])},s=[];for(let o=1;o<t.length;o++){const i=t[o].trim();if(!i)continue;const a=P(i),c=Q(a,r,o);c.title&&s.push(c)}return s}function P(e){const t=[];let n="",r=!1;for(let s=0;s<e.length;s++){const o=e[s],i=e[s+1];o==='"'?r&&i==='"'?(n+='"',s++):r=!r:o===","&&!r?(t.push(n.trim()),n=""):n+=o}return t.push(n.trim()),t}function d(e,t){for(const n of t){const r=e.indexOf(n);if(r!==-1)return r}return-1}function Q(e,t,n){const r=v=>v>=0&&v<e.length?e[v]:"",s=r(t.title),o=r(t.authors),i=r(t.year),a=r(t.venue),c=r(t.type);let y=0;if(i){const v=i.match(/\d{4}/);v&&(y=parseInt(v[0]))}let p="misc";const l=c.toLowerCase();l.includes("conference")||l.includes("inproceedings")?p="conference":l.includes("article")||l.includes("journal")?p="article":(l.includes("preprint")||l.includes("arxiv"))&&(p="preprint");const _=Z(o);return{key:`csv_entry_${n}`,type:p,title:s||"Untitled",authors:_,year:y,venue:a,pages:r(t.pages),doi:r(t.doi)||null,url:r(t.url)||null,pdfUrl:null,eprint:null,publisher:r(t.publisher)||null,volume:r(t.volume)||null,number:r(t.number)||null}}function Z(e){if(!e)return"";let t=e.split(/\s*;\s*|\s+and\s+/i).map(n=>n.trim()).filter(n=>n.length>0);if(t.length===1&&t[0].includes(",")){const n=t[0].split(",").map(r=>r.trim());n.length>2&&(t=n)}return t.join(", ")}function G(e,t){if(t.innerHTML="",!e||e.length===0){t.innerHTML=`
            <div class="empty-state">
                <span class="empty-icon">üìñ</span>
                <p>No publications found</p>
            </div>
        `;return}e.forEach((n,r)=>{const s=document.createElement("div");s.className="year-group",s.style.animationDelay=`${r*.1}s`,s.innerHTML=`
            <div class="year-header">
                <span class="year-badge">${n.year}</span>
                <span class="year-count">${n.publications.length} publication${n.publications.length!==1?"s":""}</span>
            </div>
            <div class="year-publications">
                ${n.publications.map((o,i)=>ee(o,i,n.year==="All Publications"||isNaN(n.year))).join("")}
            </div>
        `,t.appendChild(s)})}function ee(e,t,n=!1){const r=te(e),s=e.pdfUrl||e.url||e.doi?`<a href="${e.pdfUrl||e.url||`https://doi.org/${e.doi}`}" target="_blank" rel="noopener">${b(e.title)}</a>`:b(e.title);return`
        <article class="pub-card" style="animation-delay: ${t*.05}s">
            <div class="pub-content">
                <h3 class="pub-title">${s}<span class="pub-type-badge ${e.type}">${ne(e.type)}</span></h3>
                <p class="pub-authors">${b(e.authors)}</p>
                <div class="pub-venue">
                    ${e.venue?`<span><em>${b(e.venue)}</em></span>`:""}
                    ${e.volume?`<span>${e.volume}${e.number?`.${e.number}`:""}</span>`:""}
                    ${n&&e.year?`<span>(${e.year})</span>`:""}
                    ${e.publisher?`<span>${b(e.publisher)}</span>`:""}
                    ${e.pages?`<span>pages ${e.pages}</span>`:e.year>=new Date().getFullYear()?"<span>to appear</span>":""}
                </div>
                ${e.awards&&e.awards.length>0?`
                    <div class="pub-awards">
                        ${e.awards.map(o=>`<span class="pub-award">üèÜ ${b(o)}</span>`).join("")}
                    </div>
                `:""}
                ${r.length>0?`
                    <div class="pub-links">
                        ${r.join("")}
                    </div>
                `:""}
            </div>
        </article>
    `}function te(e){const t=[];e.raw&&t.push(`<a href="#" class="pub-link bibtex-link" data-key="${e.key}" onclick="return false;">BibTeX</a>`);const n=e.pdfUrl||e.url;return n&&t.push(`<a href="${n}" class="pub-link" target="_blank" rel="noopener">PDF</a>`),e.doi&&t.push(`<a href="https://doi.org/${e.doi}" class="pub-link" target="_blank" rel="noopener">DOI</a>`),e.eprint&&t.push(`<a href="https://arxiv.org/abs/${e.eprint}" class="pub-link" target="_blank" rel="noopener">arXiv</a>`),t}function ne(e){return{conference:"Conference",journal:"Journal",book:"Book",techreport:"Tech Report",thesis:"Thesis",preprint:"Preprint",misc:"Other"}[e]||"Other"}function re(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function b(e){return e?re(e).replace(/&lt;sup&gt;/g,"<sup>").replace(/&lt;\/sup&gt;/g,"</sup>").replace(/&lt;sub&gt;/g,"<sub>").replace(/&lt;\/sub&gt;/g,"</sub>").replace(/&lt;em&gt;/g,"<em>").replace(/&lt;\/em&gt;/g,"</em>").replace(/&lt;strong&gt;/g,"<strong>").replace(/&lt;\/strong&gt;/g,"</strong>"):""}function F(e){const t=e.length,n=new Set(e.map(s=>s.year).filter(s=>s>0)),r=new Set(e.map(s=>s.venue).filter(s=>s));document.getElementById("totalPubs").textContent=t,document.getElementById("totalYears").textContent=n.size,document.getElementById("totalVenues").textContent=r.size,document.getElementById("stats-section").style.display="block"}let E="bib",u=[],k="",L="";const I=document.getElementById("fileInput"),f=document.getElementById("dropZone"),m=document.getElementById("urlInput"),se=document.getElementById("loadUrlBtn"),O=document.getElementById("publications-container"),oe=document.getElementById("filtersSection"),T=document.getElementById("loadingOverlay"),U=document.querySelectorAll(".group-btn"),ie=document.getElementById("exportFormat"),ae=document.getElementById("searchInput"),R=document.getElementById("excludePreprints"),B=document.getElementById("bibtexModal"),S=document.getElementById("bibtexContent"),le=document.getElementById("closeModal"),w=document.getElementById("copyBibtex"),ce="https://raw.githubusercontent.com/dynaroars/latex-cv/main/cv.bib";function de(){ue();const n=new URLSearchParams(window.location.search).get("bib")||ce;m.value=n,C(n)}function ue(){I.addEventListener("change",fe),f.addEventListener("dragover",me),f.addEventListener("dragleave",he),f.addEventListener("drop",ge),f.addEventListener("click",e=>{e.target.tagName!=="INPUT"&&e.target.tagName!=="BUTTON"&&!e.target.closest(".url-row")&&I.click()}),se.addEventListener("click",e=>{e.stopPropagation(),C(m.value)}),m.addEventListener("keydown",e=>{e.key==="Enter"&&C(m.value)}),m.addEventListener("click",e=>{e.stopPropagation()}),U.forEach(e=>{e.addEventListener("click",()=>{U.forEach(t=>t.classList.remove("active")),e.classList.add("active"),k=e.dataset.group,x()})}),ie.addEventListener("change",e=>{e.target.value&&u.length>0&&(ye(e.target.value),e.target.value="")}),ae.addEventListener("input",e=>{L=e.target.value.toLowerCase().trim(),x()}),R.addEventListener("change",()=>{x()}),O.addEventListener("click",e=>{const t=e.target.closest(".bibtex-link");if(t){const n=t.dataset.key,r=u.find(s=>s.key===n);r&&r.raw&&pe(r.raw)}}),le.addEventListener("click",j),window.addEventListener("click",e=>{e.target===B&&j()}),w.addEventListener("click",()=>{navigator.clipboard.writeText(S.textContent).then(()=>{const e=w.textContent;w.textContent="Copied!",w.classList.add("btn-success"),setTimeout(()=>{w.textContent=e,w.classList.remove("btn-success")},2e3)})})}function pe(e){S.textContent=e,B.classList.remove("hidden"),document.body.style.overflow="hidden"}function j(){B.classList.add("hidden"),document.body.style.overflow=""}function fe(e){const t=e.target.files[0];t&&N(t)}function me(e){e.preventDefault(),e.stopPropagation(),f.classList.add("drag-over")}function he(e){e.preventDefault(),e.stopPropagation(),f.classList.remove("drag-over")}function ge(e){e.preventDefault(),e.stopPropagation(),f.classList.remove("drag-over");const t=e.dataTransfer.files[0];t&&(t.name.endsWith(".bib")||t.name.endsWith(".bibtex")||t.name.endsWith(".csv"))?N(t):g("Please drop a valid .bib or .csv file")}function N(e){h(!0),E=e.name.endsWith(".csv")?"csv":"bib";const t=new FileReader;t.onload=n=>D(n.target.result,E),t.onerror=()=>{h(!1),g("Failed to read file")},t.readAsText(e)}async function C(e){if(!e){g("Please enter a URL");return}e.match(/^https?:\/\//i)||(e="https://"+e,m.value=e);try{new URL(e)}catch{g("Please enter a valid URL");return}e.includes("github.com")&&e.includes("/blob/")&&(e=e.replace("github.com","raw.githubusercontent.com").replace("/blob/","/"),m.value=e),E=e.toLowerCase().endsWith(".csv")?"csv":"bib",h(!0);try{let t,n;try{if(t=await fetch(e),!t.ok)throw new Error(`HTTP ${t.status}`)}catch(s){n=s,t=null}if(!t)try{const s=`https://api.allorigins.win/raw?url=${encodeURIComponent(e)}`;if(t=await fetch(s),!t.ok)throw new Error(`HTTP ${t.status}`)}catch(s){n=s,t=null}if(!t)try{const s=`https://corsproxy.io/?${encodeURIComponent(e)}`;if(t=await fetch(s),!t.ok)throw new Error(`HTTP ${t.status}`)}catch(s){n=s,t=null}if(!t)throw n||new Error("Failed to fetch from all sources");const r=await t.text();D(r,E)}catch(t){h(!1),g(`Failed to load file: ${t.message}`)}}function D(e,t){try{if(u=t==="csv"?J(e):A(e),u.length===0){h(!1),g(`No publications found in the ${t.toUpperCase()} file`);return}F(u),x(),oe.style.display="flex",h(!1)}catch(n){h(!1),g(`Failed to parse ${t.toUpperCase()}: ${n.message}`),console.error("Parse error:",n)}}function x(){let e=u;L&&(e=e.filter(r=>{var o;return[r.title,r.authors,r.venue,(o=r.year)==null?void 0:o.toString(),r.type].filter(Boolean).join(" ").toLowerCase().includes(L)})),R.checked&&(e=e.filter(r=>r.type!=="preprint"));let t;k==="year"?t=X(e):k==="type"?t=K(e):t=q(e),G(t,O),F(e);const n=document.getElementById("searchCount");n&&(n.textContent=L?`Showing ${e.length} of ${u.length}`:"")}function h(e){e?T.classList.remove("hidden"):T.classList.add("hidden")}function g(e){const t=document.createElement("div");t.style.cssText=`
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        padding: 1rem 2rem;
        background: #333;
        color: white;
        font-weight: 500;
        z-index: 1000;
        animation: fadeIn 0.3s ease;
    `,t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity 0.3s ease",setTimeout(()=>t.remove(),300)},4e3)}function ye(e){let t,n,r;switch(e){case"bibtex":t=ve(u),n="publications.bib",r="text/plain";break;case"csv":t=be(u),n="publications.csv",r="text/csv";break;default:return}we(t,n,r)}function ve(e){return e.map(t=>{let r=`@${t.type==="article"?"article":t.type==="conference"?"inproceedings":"misc"}{${t.key},
`;return r+=`  title = {${t.title}},
`,r+=`  author = {${t.authors}},
`,t.year&&(r+=`  year = {${t.year}},
`),t.venue&&(t.type==="article"?r+=`  journal = {${t.venue}},
`:r+=`  booktitle = {${t.venue}},
`),t.pages&&(r+=`  pages = {${t.pages}},
`),t.doi&&(r+=`  doi = {${t.doi}},
`),t.url&&(r+=`  url = {${t.url}},
`),t.volume&&(r+=`  volume = {${t.volume}},
`),t.number&&(r+=`  number = {${t.number}},
`),t.publisher&&(r+=`  publisher = {${t.publisher}},
`),r+=`}
`,r}).join(`
`)}function be(e){const t=["Title","Authors","Year","Type","Venue","Pages","DOI","URL"],n=e.map(r=>[`"${(r.title||"").replace(/"/g,'""')}"`,`"${(r.authors||"").replace(/"/g,'""')}"`,r.year||"",r.type||"",`"${(r.venue||"").replace(/"/g,'""')}"`,r.pages||"",r.doi||"",r.url||""]);return[t.join(","),...n.map(r=>r.join(","))].join(`
`)}function we(e,t,n){const r=new Blob([e],{type:n}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}de();
